---
# Source: testlib/templates/test.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: test-testlib-capabilities-helm
  labels:
    helm.sh/chart: testlib-0.1.0
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: testlib
    app.kubernetes.io/instance: test
    app.kubernetes.io/component: main
data:
  git_commit: d14138609b01886f544b2025f5000351c9eb092e
  git_tree_state: clean
  go_version: go1.17.5
  version: v3.8.0
---
# Source: testlib/templates/test.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: test-testlib-capabilities-kube
  labels:
    helm.sh/chart: testlib-0.1.0
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: testlib
    app.kubernetes.io/instance: test
    app.kubernetes.io/component: main
data:
  Major: "1"
  Minor: "23"
  Version: v1.23.0
---
# Source: testlib/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-testlib
  labels:
    helm.sh/chart: testlib-0.1.0
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: testlib
    app.kubernetes.io/instance: test
    app.kubernetes.io/component: main
  annotations:
    name: main
    name2: main
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: testlib
      app.kubernetes.io/instance: test
      app.kubernetes.io/component: main
  template:
    metadata:
      labels:
        app.kubernetes.io/name: testlib
        app.kubernetes.io/instance: test
        app.kubernetes.io/component: main
      annotations:
        podname: main
        podname2: main
    spec:

      serviceAccountName: default
      securityContext:
        runAsNonRoot: true
        runAsUser: 36
      affinity:
        {}
      containers:
        - name: "main"
          securityContext:
            runAsNonRoot: true
            runAsUser: 36
          image: "camptocamp/main:latest"
          imagePullPolicy: IfNotPresent
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 2
              memory: 2Gi
            requests:
              cpu: 20m
              memory: 200Mi
---
# Source: testlib/templates/sub-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-testlib-sub
  labels:
    helm.sh/chart: testlib-0.1.0
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: testlib
    app.kubernetes.io/instance: test
    app.kubernetes.io/component: sub
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app.kubernetes.io/name: testlib
      app.kubernetes.io/instance: test
      app.kubernetes.io/component: sub
  template:
    metadata:
      labels:
        app.kubernetes.io/name: testlib
        app.kubernetes.io/instance: test
        app.kubernetes.io/component: sub
    spec:

      serviceAccountName: default
      securityContext:
        runAsNonRoot: true
        runAsUser: 36
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/component
                operator: In
                values:
                - sub
              - key: app.kubernetes.io/instance
                operator: In
                values:
                - test
              - key: app.kubernetes.io/name
                operator: In
                values:
                - testlib
            topologyKey: "kubernetes.io/hostname"
      containers:
        - name: "main"
          securityContext:
            runAsNonRoot: true
            runAsUser: 36
          image: "camptocamp/sub@sha256:1234"
          imagePullPolicy: IfNotPresent
          env:
              - name: "comfigmap"
                valueFrom:
                  secretKeyRef:
                    name: "s"
                    key: "data"
              - name: "configmap"
                valueFrom:
                  configMapKeyRef:
                    name: "cm"
                    key: "data"
              - name: "configmapoverride"
                valueFrom:
                  configMapKeyRef:
                    name: "overitten"
                    key: "data"
              - name: "direct"
                value: "test"
              - name: "directvalue"
                value: "test"
          terminationMessagePolicy: FallbackToLogsOnError
          resources:
            limits:
              cpu: 1
              memory: 1Gi
            requests:
              cpu: 10m
              memory: 100Mi
